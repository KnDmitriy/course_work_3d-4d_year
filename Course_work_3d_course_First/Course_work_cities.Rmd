```{r}
install_or_load_pack <- function(pack){
   create.pkg <- pack[!(pack %in% installed.packages()[, "Package"])]
    if (length(create.pkg))
     install.packages(create.pkg, dependencies = TRUE)
     sapply(pack, require, character.only = TRUE)
}
packages <- c("ggplot2",  "data.table", "wordcloud", "tm", "wordcloud2","scales", "tidytext", "devtools", "twitteR", "caret", "magrittr", "RColorBrewer", "ggdendro","tidyr", "topicmodels", "SnowballC", "gtools", "dplyr", 'tidyverse', 'readxl')
install_or_load_pack(packages)
```

```{r}
path_city <- "/Users/DmitryKonorov/Desktop/Основная_учеба/3й_курс/Курсовая_3й_курс/Course_work_3d_course_First/Data/2021_Respublika_Tatarstan_posty.xlsx"
```

```{r}
city_df <- read_excel(path)
```

```{r}
head(city_df)
```

```{r}
corp_city_df <- Corpus(VectorSource(city_df))
```

```{r}
clean_corpus <- function(corpus_to_use){
corpus_to_use %>%
   tm_map(removePunctuation) %>%
   tm_map(stripWhitespace) %>%
   tm_map(content_transformer(function(x) iconv(x, to='UTF-8', sub='byte'))) %>%
   tm_map(removeNumbers) %>%
   tm_map(content_transformer(tolower)) %>%
   tm_map(removeWords, c(stopwords("russian"),"это", "также",
                                            "быть", "мочь", "–")) 
}
```

```{r}
corp_city_df <- clean_corpus(corp_city_df)
```

```{r}
tdm <- TermDocumentMatrix(corp_city_df)
m <- as.matrix(tdm)
v <- sort(rowSums(m), decreasing = TRUE)
d <- data.frame(word = names(v), freq = v)
```

```{r}
top_n(d, 10)
```
```{r}
wordcloud(d$word, d$freq, random.order=FALSE, rot.per=0.3, scale=c(4, .5), max.words=101, colors=brewer.pal(8, "Dark2"))
```

```{r}
library(udpipe)
```
```{r}
gsd <- udpipe_download_model(language = "russian-gsd")
str(dl)
```

```{r}
```

```{r}
```

```{r}
```





